<!DOCTYPE html>
<html>
<head>
    <title>Frédéric MIRMAN Labs</title>
	<style>
		#windChat{
			height:150px;
			overflow:auto;
		}
		ul{
			/*list-style-type:none; */
		}
		
		.intro{
			background:url("public/img/motif.png") repeat scroll 0 0 #27437B;
			height:20%;
			color:white;
			padding:10px;
			border-bottom: 3px solid #5A72A6;
			/*text-align:right;*/
		}
		.spacer{
			/*margin-right:50px;*/
			padding-right:10px;
			/*width:33%;*/
		}
	</style>
	<script src="http://code.jquery.com/jquery-latest.js"></script>
	
	<link rel="stylesheet" href="public/styles/jPicker-1.1.6.min.css"/>
    <!-- Include the socket.io javascript on the client side -->
    <script src="socket.io/socket.io.js"></script>
    <script src="public/script/jpicker-1.1.6.min.js"></script>
	<script src="public/script/jquery.qrcode.js"></script>
	<script src="public/script/qrcode.js"></script>
	
	
	<meta name="viewport" content="width=device-width, initial-scale=1"> 
	<link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
	<script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>
	
	<script src="public/script/jcanvas.min.js"></script>
	
</head>

<body>
	<div data-role="page">

		<div data-role="header">
			<h1>Frédéric MIRMAN Labs</h1>
			
		</div><!-- /header -->
		
		<div class="intro">
			Ce site est un laboratoire de Frédéric Mirman sur les NTIC. Il tourne sur un serveur Node.JS et héberger par heroku via GIT.
			<br/>Ce site est structuré selon le Responsive Design.
		</div>
		
		<div data-role="content">		
			
			
			<!--div class="ui-grid-b spacer">
				<div class="ui-block-a spacer"-->
			<table align="center" cellpadding=0 cellspacing=0>
				<tr>
				<td>
			<div>
				<div style="float:left" class="spacer">
					<h1 >Découvrez</h1> 
					<img src="public/img/nodejs-light.png"/>
					
					<br><br><br>
					<h2>Bienvenue sur un chat fait en Node.JS</h2>
				 
					<label for="nickname-input">Votre surnom :</label>
					<input id="nickname-input" name="nickname-input" title="Surnom" type="text" size="30" />
					<br/>
					<label for="msg-input">Votre message :</label>
					<input id="msg-input" name="msg-input" title="Message" type="text" size="30" />
					<p>Appuyez sur Entrée pour envoyer votre message</p>
					<div id="windChat">
						<ul id="broadcast-msg"></ul>
					</div>
				</div>
		
		
				<!--div class="ui-block-b spacer"-->
				<div style="float:left" class="spacer">
					<h1>Découvrez HTML5 : Canvas</h1>
					<div>
						<span id="Inline"></span>
						<input type="range" name="slider-fill" id="slider-fill" value="5" min="0" max="50" data-highlight="true" />
					</div>
					<br>
					<div>
						<canvas id="myCanvas" width="400" height="500" style="border:1px solid #000000;">
						</canvas> 
					</div>
					
				</div>
			
				<!--div class="ui-block-c spacer"-->
				<div style="float:left" class="spacer">
					<h1>Découvrez jQuery QRcode</h1>
					<label for="qrc-input">Votre text contenu dans le QRCode :</label>
					<input id="qrc-input" name="qrc-input" title="text qrc" value="http://google.fr" type="text" size="30" />
					<p>Appuyez sur Entrée pour afficher votre QRCode</p>
					<br/><div id="qrcode"></div>
				</div>
			
			</div>
			</td>
			</tr>
			</table><!---->
				
				
		</div><!-- /content -->

	</div><!-- /page -->
	
	
	
	
	<script>
		// Establish the connection with the server
		var socket = io.connect('http://localhost:5000');
		
		// qrcode
		var txtQRcode = "http://mirman.frederic.free.fr/m/";
		// canvas
		var colorChose = "#40A497";
		var radiusChose = 5;
		
		$(document).ready(function() {
			// create qrcode
			$('#qrcode').qrcode({
				text: txtQRcode,
				width: 156,
				height: 156
			});
			
			// event on canvas
			$("#myCanvas").click(clickReporter);
			resizeCanvas();
			$(window).resize(function() {
				resizeCanvas();
			});
			
			
			
			
			// init color
			$('#Inline').jPicker(
				{
					window:{
						position:{x:'30',y:'center'},
						expandable: true,liveUpdate: true
					},
					color: {active: colorChose}
				},
				function(color, context)
				{
					var all = color.val('all');
					colorChose = "#"+all.hex;
				}
			);
		});
		
		
		function resizeCanvas() {
			var sizeW = $(window).width();
			if ( sizeW > 332)
				$( "#myCanvas" ).attr("width", $(window).width()/3);
			else
				$( "#myCanvas" ).attr("width", 300);
		}
		
		
		
		function clickReporter(e) {
			$("#myCanvas").drawArc({
			  fillStyle: colorChose,
			  x: e.pageX - $(this).position().left, 
			  y: e.pageY - $(this).position().top,
			  radius: radiusChose
			});
		}
		
		
		
		$('#slider-fill').live('change', function(event) {
			radiusChose = $(this).val();
		});
		
		$('#qrc-input').change( function(){
			$('#qrcode').empty();
			txtQRcode = $(this).val();
			$('#qrcode').qrcode({
				text: txtQRcode,
				width: 156,
				height: 156
			});
		});

		// on every message recived we print the new datas inside the #broadcast-msg div
		socket.on('broadcast_msg', function (data) {
			console.log('Get broadcasted msg:', data);
			var msg = '<li>' + data + '</li>';
			$('#broadcast-msg').append(msg);
		});
	 
		// Create a new socket connection
		socket.on('connect', function() {
	 
			//socket.emit('set nickname', prompt('What is your nickname?'));
	 
			$('#nickname-input').change( function(){
				var txt = $(this).val();
				//$(this).val('');
				socket.emit('set nickname', txt, function (data){
													console.log('Emit nickname', data);
												}
				);
			});
			
			$('#msg-input').change( function(){
				var txt = $(this).val();
				$(this).val('');
				socket.emit('emit_msg', txt, function (data){
					console.log('Emit Broadcast msg', data);
				});
			});
	 
		});
	</script>
	
</body>
</html>